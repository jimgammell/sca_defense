Results will be stored in /local/scratch/a/jgammell/sca_defense/sca_code/gan_defense/results/2022-1-20_18-43-55.
Generating training data...
	Done. Time taken: 51.865614 seconds.
Generating test data...
	Done. Time taken: 50.855258 seconds.
Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
	Done. Time taken: 8.172833 seconds.
Training modified discriminator...
	Done. Time taken: 6076.030380 seconds.
Beginning trial with IdentityGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
==================================================================================================
Total params: 0
Trainable params: 0
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.253030 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        0           input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.638823 seconds.
	Training model...
		Done. Time taken: 2634.319222 seconds.
	Plotting some power traces...
		Done. Time taken: 9.589430 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.291260.
		Done. Time taken: 131.168556 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6066.383364 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.168457.
		Done. Time taken: 134.513860 seconds.
	Done with trial. Time taken: 9000.500345 seconds.
Beginning trial with LinearGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_7 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense (Dense)                   (None, 20000)        180000      input_7[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid (TFOpLambda)    (None, 20000)        0           dense[0][0]                      
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 20000)        0           tf.math.sigmoid[0][0]            
__________________________________________________________________________________________________
input_8 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add (Add)                       (None, 20000)        0           lambda_2[0][0]                   
                                                                 input_8[0][0]                    
==================================================================================================
Total params: 180,000
Trainable params: 180,000
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.323790 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_9 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_10 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        180000      input_9[0][0]                    
                                                                 input_10[0][0]                   
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,302,388
Trainable params: 1,293,106
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.700304 seconds.
	Training model...
		Done. Time taken: 3774.299754 seconds.
	Plotting some power traces...
		Done. Time taken: 9.466507 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.003906.
		Done. Time taken: 127.691130 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6068.162241 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.419678.
		Done. Time taken: 125.946941 seconds.
	Done with trial. Time taken: 10127.794193 seconds.
Beginning trial with Mlp1Generator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           576         input_11[0][0]                   
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 64)           0           dense_1[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 20000)        1300000     re_lu[0][0]                      
__________________________________________________________________________________________________
tf.math.sigmoid_1 (TFOpLambda)  (None, 20000)        0           dense_2[0][0]                    
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 20000)        0           tf.math.sigmoid_1[0][0]          
__________________________________________________________________________________________________
input_12 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 20000)        0           lambda_3[0][0]                   
                                                                 input_12[0][0]                   
==================================================================================================
Total params: 1,300,576
Trainable params: 1,300,576
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.314571 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_13 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_14 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        1300576     input_13[0][0]                   
                                                                 input_14[0][0]                   
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 2,422,964
Trainable params: 2,413,682
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.651400 seconds.
	Training model...
		Done. Time taken: 3768.980479 seconds.
	Plotting some power traces...
		Done. Time taken: 9.422524 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.000000.
		Done. Time taken: 126.073290 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6067.041484 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.985107.
		Done. Time taken: 126.747043 seconds.
	Done with trial. Time taken: 10120.696163 seconds.
Beginning trial with Mlp3Generator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_15 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           576         input_15[0][0]                   
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 64)           0           dense_3[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 64)           4160        re_lu_1[0][0]                    
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64)           0           dense_4[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 64)           4160        re_lu_2[0][0]                    
__________________________________________________________________________________________________
re_lu_3 (ReLU)                  (None, 64)           0           dense_5[0][0]                    
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 20000)        1300000     re_lu_3[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid_2 (TFOpLambda)  (None, 20000)        0           dense_6[0][0]                    
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 20000)        0           tf.math.sigmoid_2[0][0]          
__________________________________________________________________________________________________
input_16 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add_2 (Add)                     (None, 20000)        0           lambda_4[0][0]                   
                                                                 input_16[0][0]                   
==================================================================================================
Total params: 1,308,896
Trainable params: 1,308,896
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.356510 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_17 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_18 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        1308896     input_17[0][0]                   
                                                                 input_18[0][0]                   
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 2,431,284
Trainable params: 2,422,002
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.664938 seconds.
	Training model...
		Done. Time taken: 3770.782830 seconds.
	Plotting some power traces...
		Done. Time taken: 9.439158 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.000000.
		Done. Time taken: 126.990658 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6071.260053 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.520996.
		Done. Time taken: 126.465015 seconds.
	Done with trial. Time taken: 10127.606548 seconds.
Beginning trial with CnnTransposeGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_19 (InputLayer)           [(None, 8, 1)]       0                                            
__________________________________________________________________________________________________
conv1d_transpose (Conv1DTranspo (None, 40, 20)       80          input_19[0][0]                   
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 40, 20)       80          conv1d_transpose[0][0]           
__________________________________________________________________________________________________
re_lu_4 (ReLU)                  (None, 40, 20)       0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv1d_transpose_1 (Conv1DTrans (None, 200, 20)      1220        re_lu_4[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 200, 20)      80          conv1d_transpose_1[0][0]         
__________________________________________________________________________________________________
re_lu_5 (ReLU)                  (None, 200, 20)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv1d_transpose_2 (Conv1DTrans (None, 1000, 20)     1220        re_lu_5[0][0]                    
__________________________________________________________________________________________________
flatten (Flatten)               (None, 20000)        0           conv1d_transpose_2[0][0]         
__________________________________________________________________________________________________
tf.math.sigmoid_3 (TFOpLambda)  (None, 20000)        0           flatten[0][0]                    
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 20000)        0           tf.math.sigmoid_3[0][0]          
__________________________________________________________________________________________________
input_20 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add_3 (Add)                     (None, 20000)        0           lambda_5[0][0]                   
                                                                 input_20[0][0]                   
==================================================================================================
Total params: 2,680
Trainable params: 2,600
Non-trainable params: 80
__________________________________________________________________________________________________
		Done. Time taken: 0.427411 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_21 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_22 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        2680        input_21[0][0]                   
                                                                 input_22[0][0]                   
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,125,068
Trainable params: 1,115,706
Non-trainable params: 9,362
__________________________________________________________________________________________________
		Done. Time taken: 0.700020 seconds.
	Training model...
		Done. Time taken: 3780.573839 seconds.
	Plotting some power traces...
		Done. Time taken: 10.781731 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.003418.
		Done. Time taken: 126.759013 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6081.363627 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.995605.
		Done. Time taken: 127.272150 seconds.
	Done with trial. Time taken: 10149.248323 seconds.
Beginning trial with FourierGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_23 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 512)          4608        input_23[0][0]                   
__________________________________________________________________________________________________
re_lu_7 (ReLU)                  (None, 512)          0           dense_9[0][0]                    
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 512)          4608        input_23[0][0]                   
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 100)          51300       re_lu_7[0][0]                    
__________________________________________________________________________________________________
re_lu_8 (ReLU)                  (None, 512)          0           dense_11[0][0]                   
__________________________________________________________________________________________________
tf.math.sigmoid_4 (TFOpLambda)  (None, 100)          0           dense_10[0][0]                   
__________________________________________________________________________________________________
input_25 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 100)          51300       re_lu_8[0][0]                    
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 100)          0           tf.math.sigmoid_4[0][0]          
__________________________________________________________________________________________________
repeat_vector_3 (RepeatVector)  (None, 100, 20000)   0           input_25[0][0]                   
__________________________________________________________________________________________________
tf.math.sigmoid_5 (TFOpLambda)  (None, 100)          0           dense_12[0][0]                   
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 512)          4608        input_23[0][0]                   
__________________________________________________________________________________________________
repeat_vector_1 (RepeatVector)  (None, 20000, 100)   0           lambda_6[0][0]                   
__________________________________________________________________________________________________
permute (Permute)               (None, 20000, 100)   0           repeat_vector_3[0][0]            
__________________________________________________________________________________________________
lambda_7 (Lambda)               (None, 100)          0           tf.math.sigmoid_5[0][0]          
__________________________________________________________________________________________________
re_lu_6 (ReLU)                  (None, 512)          0           dense_7[0][0]                    
__________________________________________________________________________________________________
multiply (Multiply)             (None, 20000, 100)   0           repeat_vector_1[0][0]            
                                                                 permute[0][0]                    
__________________________________________________________________________________________________
repeat_vector_2 (RepeatVector)  (None, 20000, 100)   0           lambda_7[0][0]                   
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 100)          51300       re_lu_6[0][0]                    
__________________________________________________________________________________________________
add_4 (Add)                     (None, 20000, 100)   0           multiply[0][0]                   
                                                                 repeat_vector_2[0][0]            
__________________________________________________________________________________________________
repeat_vector (RepeatVector)    (None, 20000, 100)   0           dense_8[0][0]                    
__________________________________________________________________________________________________
lambda_8 (Lambda)               (None, 20000, 100)   0           add_4[0][0]                      
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 20000, 100)   0           repeat_vector[0][0]              
                                                                 lambda_8[0][0]                   
__________________________________________________________________________________________________
lambda_9 (Lambda)               (None, 20000)        0           multiply_1[0][0]                 
__________________________________________________________________________________________________
tf.math.sigmoid_6 (TFOpLambda)  (None, 20000)        0           lambda_9[0][0]                   
__________________________________________________________________________________________________
lambda_10 (Lambda)              (None, 20000)        0           tf.math.sigmoid_6[0][0]          
__________________________________________________________________________________________________
input_24 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add_5 (Add)                     (None, 20000)        0           lambda_10[0][0]                  
                                                                 input_24[0][0]                   
==================================================================================================
Total params: 167,724
Trainable params: 167,724
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.513005 seconds.
	Creating cumulative model...
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_26 (InputLayer)           [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_27 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
input_28 (InputLayer)           [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        167724      input_26[0][0]                   
                                                                 input_27[0][0]                   
                                                                 input_28[0][0]                   
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,290,112
Trainable params: 1,280,830
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.672225 seconds.
	Training model...
		Done. Time taken: 4971.922801 seconds.
	Plotting some power traces...
		Done. Time taken: 9.680212 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.003174.
		Done. Time taken: 135.300473 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 6883.769653 seconds.
	Evaluating model performance with retrained discriminator...
		Proportion of attack points correct: 0.664062.
		Done. Time taken: 137.601034 seconds.
	Done with trial. Time taken: 12163.191338 seconds.
