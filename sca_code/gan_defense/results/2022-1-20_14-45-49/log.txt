Results will be stored in /local/scratch/a/jgammell/sca_defense/sca_code/gan_defense/results/2022-1-20_14-45-49.
Generating training data...
	Done. Time taken: 52.374405 seconds.
Generating test data...
	Done. Time taken: 50.781631 seconds.
Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
	Done. Time taken: 8.070190 seconds.
Training modified discriminator...
	Done. Time taken: 214.697552 seconds.
Beginning trial with FourierGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 512)          4608        input_3[0][0]                    
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 512)          0           dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 512)          4608        input_3[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 100)          51300       re_lu_1[0][0]                    
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 512)          0           dense_4[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid (TFOpLambda)    (None, 100)          0           dense_3[0][0]                    
__________________________________________________________________________________________________
input_5 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 100)          51300       re_lu_2[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 100)          0           tf.math.sigmoid[0][0]            
__________________________________________________________________________________________________
repeat_vector_3 (RepeatVector)  (None, 100, 20000)   0           input_5[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid_1 (TFOpLambda)  (None, 100)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 512)          4608        input_3[0][0]                    
__________________________________________________________________________________________________
repeat_vector_1 (RepeatVector)  (None, 20000, 100)   0           lambda_2[0][0]                   
__________________________________________________________________________________________________
permute (Permute)               (None, 20000, 100)   0           repeat_vector_3[0][0]            
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 100)          0           tf.math.sigmoid_1[0][0]          
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 512)          0           dense[0][0]                      
__________________________________________________________________________________________________
multiply (Multiply)             (None, 20000, 100)   0           repeat_vector_1[0][0]            
                                                                 permute[0][0]                    
__________________________________________________________________________________________________
repeat_vector_2 (RepeatVector)  (None, 20000, 100)   0           lambda_3[0][0]                   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 100)          51300       re_lu[0][0]                      
__________________________________________________________________________________________________
add (Add)                       (None, 20000, 100)   0           multiply[0][0]                   
                                                                 repeat_vector_2[0][0]            
__________________________________________________________________________________________________
repeat_vector (RepeatVector)    (None, 20000, 100)   0           dense_1[0][0]                    
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 20000, 100)   0           add[0][0]                        
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 20000, 100)   0           repeat_vector[0][0]              
                                                                 lambda_4[0][0]                   
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 20000)        0           multiply_1[0][0]                 
__________________________________________________________________________________________________
tf.math.sigmoid_2 (TFOpLambda)  (None, 20000)        0           lambda_5[0][0]                   
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 20000)        0           tf.math.sigmoid_2[0][0]          
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add_1 (Add)                     (None, 20000)        0           lambda_6[0][0]                   
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 167,724
Trainable params: 167,724
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.473554 seconds.
	Creating cumulative model...
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_7 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
input_8 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        167724      input_6[0][0]                    
                                                                 input_7[0][0]                    
                                                                 input_8[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,290,112
Trainable params: 1,280,830
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.653002 seconds.
	Training model...
		Done. Time taken: 227.793289 seconds.
	Plotting some power traces...
		Done. Time taken: 10.078654 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.001709.
		Done. Time taken: 133.382651 seconds.
	Retraining discriminator on protected trace...
