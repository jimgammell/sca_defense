Results will be stored in /local/scratch/a/jgammell/sca_defense/sca_code/gan_defense/results/2022-1-22_13-5-21.
Generating training data...
	Done. Time taken: 53.212489 seconds.
Generating test data...
	Done. Time taken: 53.110700 seconds.
Beginning trial with IdentityGenerator generator.
	Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
		Done. Time taken: 9.280599 seconds.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
==================================================================================================
Total params: 0
Trainable params: 0
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.140194 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        0           input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.537717 seconds.
	Training modified discriminator...
		Done. Time taken: 284.077716 seconds.
	Training generator...
		Done. Time taken: 181.546993 seconds.
	Plotting some power traces...
		Done. Time taken: 1.762204 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 281.443415 seconds.
	Done with trial. Time taken: 758.891437 seconds.
Beginning trial with LinearGenerator generator.
	Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
		Done. Time taken: 8.815719 seconds.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense (Dense)                   (None, 20000)        180000      input_3[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid (TFOpLambda)    (None, 20000)        0           dense[0][0]                      
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 20000)        0           tf.math.sigmoid[0][0]            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add (Add)                       (None, 20000)        0           lambda_2[0][0]                   
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 180,000
Trainable params: 180,000
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.312812 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        180000      input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,302,388
Trainable params: 1,293,106
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.654986 seconds.
	Training modified discriminator...
		Done. Time taken: 278.656980 seconds.
	Training generator...
		Done. Time taken: 213.309210 seconds.
	Plotting some power traces...
		Done. Time taken: 1.548208 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 288.228851 seconds.
	Done with trial. Time taken: 791.663847 seconds.
Beginning trial with Mlp1Generator generator.
	Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
		Done. Time taken: 8.018183 seconds.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense (Dense)                   (None, 64)           576         input_3[0][0]                    
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 64)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 20000)        1300000     re_lu[0][0]                      
__________________________________________________________________________________________________
tf.math.sigmoid (TFOpLambda)    (None, 20000)        0           dense_1[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 20000)        0           tf.math.sigmoid[0][0]            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add (Add)                       (None, 20000)        0           lambda_2[0][0]                   
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 1,300,576
Trainable params: 1,300,576
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.319670 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        1300576     input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 2,422,964
Trainable params: 2,413,682
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.655556 seconds.
	Training modified discriminator...
		Done. Time taken: 277.654867 seconds.
	Training generator...
		Done. Time taken: 216.654351 seconds.
	Plotting some power traces...
		Done. Time taken: 1.617153 seconds.
	Retraining discriminator on protected trace...
		Done. Time taken: 275.597853 seconds.
	Done with trial. Time taken: 780.654871 seconds.
Beginning trial with Mlp3Generator generator.
	Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
		Done. Time taken: 8.556883 seconds.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
dense (Dense)                   (None, 64)           576         input_3[0][0]                    
__________________________________________________________________________________________________
re_lu (ReLU)                    (None, 64)           0           dense[0][0]                      
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           4160        re_lu[0][0]                      
__________________________________________________________________________________________________
re_lu_1 (ReLU)                  (None, 64)           0           dense_1[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           4160        re_lu_1[0][0]                    
__________________________________________________________________________________________________
re_lu_2 (ReLU)                  (None, 64)           0           dense_2[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 20000)        1300000     re_lu_2[0][0]                    
__________________________________________________________________________________________________
tf.math.sigmoid (TFOpLambda)    (None, 20000)        0           dense_3[0][0]                    
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 20000)        0           tf.math.sigmoid[0][0]            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
add (Add)                       (None, 20000)        0           lambda_2[0][0]                   
                                                                 input_4[0][0]                    
==================================================================================================
Total params: 1,308,896
Trainable params: 1,308,896
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.384707 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        1308896     input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 2,431,284
Trainable params: 2,422,002
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.659085 seconds.
	Training modified discriminator...
