Results will be stored in /local/scratch/a/jgammell/sca_defense/sca_code/gan_defense/results/2022-1-20_17-49-51.
Generating training data...
	Done. Time taken: 51.869147 seconds.
Generating test data...
	Done. Time taken: 51.143168 seconds.
Creating discriminator...
Model: "Discriminator"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 20000)]           0         
_________________________________________________________________
lambda (Lambda)              (None, 20000)             0         
_________________________________________________________________
lambda_1 (Lambda)            (None, 20000)             0         
_________________________________________________________________
model (Functional)           (None, 256)               1122388   
=================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
_________________________________________________________________
	Done. Time taken: 8.029183 seconds.
Training modified discriminator...
	Done. Time taken: 213.957272 seconds.
Beginning trial with IdentityGenerator generator.
	Creating generator...
Model: "Generator"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_3 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 20000)]      0                                            
==================================================================================================
Total params: 0
Trainable params: 0
Non-trainable params: 0
__________________________________________________________________________________________________
		Done. Time taken: 0.282719 seconds.
	Creating cumulative model...
Model: "Cumulative_model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_5 (InputLayer)            [(None, 8)]          0                                            
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 20000)]      0                                            
__________________________________________________________________________________________________
Generator (Functional)          (None, 20000)        0           input_5[0][0]                    
                                                                 input_6[0][0]                    
__________________________________________________________________________________________________
Discriminator (Functional)      (None, 256)          1122388     Generator[0][0]                  
==================================================================================================
Total params: 1,122,388
Trainable params: 1,113,106
Non-trainable params: 9,282
__________________________________________________________________________________________________
		Done. Time taken: 0.614518 seconds.
	Training model...
		Done. Time taken: 80.735169 seconds.
	Plotting some power traces...
		Done. Time taken: 9.368569 seconds.
	Evaluating model performance with untrained discriminator...
		Proportion of attack points correct: 0.004639.
		Done. Time taken: 124.654557 seconds.
	Retraining discriminator on protected trace...
